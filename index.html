<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CS2 Bingo ‚Äî Challenge Tracker</title>
<style>
  /* =========
     THEME SYSTEM
     ========= */
  :root{
    --bg: #111418;
    --panel: #161a20;
    --tile: #202632;
    --tile-border: #2a3240;
    --accent: #6ee7b7;      /* checkmark + focus */
    --accent-2:#38bdf8;     /* hover / highlights */
    --text: #e6edf3;
    --muted:#9aa6b2;
    --texture: radial-gradient(1200px 600px at 0% 0%, #ffffff08, #00000000 60%),
               radial-gradient(900px 600px at 100% 100%, #00000040, #0000 50%);
  }
  /* Neon */
  .theme-neon{
    --bg:#07080c; --panel:#0b0f14; --tile:#101826; --tile-border:#1b2a40;
    --accent:#22d3ee; --accent-2:#a78bfa; --text:#e6f1ff; --muted:#9fb3c8;
    --texture: radial-gradient(800px 600px at 30% 20%, #22d3ee0e, #0000 60%),
               radial-gradient(900px 600px at 80% 80%, #a78bfa12, #0000 50%);
  }
  /* Desert */
  .theme-desert{
    --bg:#1e1a15; --panel:#262018; --tile:#32281f; --tile-border:#3a2f24;
    --accent:#f59e0b; --accent-2:#84cc16; --text:#f7f2e7; --muted:#d2c3a8;
    --texture: radial-gradient(1200px 600px at 10% 5%, #f59e0b12, #0000 50%),
               radial-gradient(900px 600px at 100% 100%, #00000040, #0000 60%);
  }
  /* Arctic */
  .theme-arctic{
    --bg:#0a0f14; --panel:#0f151c; --tile:#141c26; --tile-border:#1b2735;
    --accent:#7dd3fc; --accent-2:#60a5fa; --text:#e8f3ff; --muted:#b7c7db;
    --texture: radial-gradient(900px 600px at 0% 0%, #7dd3fc10, #0000 60%),
               radial-gradient(900px 600px at 100% 100%, #60a5fa10, #0000 50%);
  }
  /* Jungle */
  .theme-jungle{
    --bg:#0e1412; --panel:#121a16; --tile:#17221d; --tile-border:#1e2b24;
    --accent:#34d399; --accent-2:#86efac; --text:#e9f7f0; --muted:#a9c7b8;
    --texture: radial-gradient(900px 600px at 20% 10%, #34d39912, #0000 55%),
               radial-gradient(900px 600px at 90% 90%, #0000003a, #0000 55%);
  }
  /* Retro */
  .theme-retro{
    --bg:#0b0d0f; --panel:#101214; --tile:#1b1f24; --tile-border:#2a2f36;
    --accent:#f472b6; --accent-2:#f59e0b; --text:#f5f5f5; --muted:#c0c4cc;
    --texture: repeating-linear-gradient(135deg,#ffffff05 0 2px,#0000 2px 6px),
               radial-gradient(900px 600px at 100% 100%, #f472b60e, #0000 60%);
  }

  /* =========
     BASE LAYOUT
     ========= */
  html,body{height:100%}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    color:var(--text);
    background: var(--bg);
    background-image: var(--texture);
    overflow-x:hidden;
  }
  .wrap{
    max-width: 1100px;
    margin: 24px auto 56px;
    padding: 0 16px;
  }
  header{
    display:flex; gap:16px; align-items:center; justify-content:space-between;
    background: color-mix(in oklab, var(--panel) 92%, #000 8%);
    border:1px solid #00000055; border-radius:14px; padding:14px 16px 14px 16px;
    box-shadow: inset 0 1px 0 #ffffff08, 0 10px 30px #00000030;
    backdrop-filter: blur(4px);
  }
  .title{
    display:flex; align-items:center; gap:12px; white-space:nowrap;
  }
  .title h1{font-size:20px; margin:0}
  .controls{
    display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end;
  }
  button,.select, .linklike{
    appearance:none; border:1px solid var(--tile-border); color:var(--text);
    background: linear-gradient(#ffffff05, #00000000);
    background-color: var(--tile);
    padding:10px 12px; border-radius:10px; font-weight:600;
    transition: transform .06s ease, border-color .15s ease, box-shadow .15s ease, background-color .2s ease;
    cursor:pointer; box-shadow: 0 1px 0 #00000080, inset 0 0 0 1px #ffffff06;
  }
  button:hover,.select:hover,.linklike:hover{
    transform: translateY(-1px);
    border-color: color-mix(in oklab, var(--accent-2) 40%, var(--tile-border));
    box-shadow: 0 6px 18px #00000045, 0 0 0 2px #0000, inset 0 0 0 1px #ffffff09;
  }
  button:active{transform: translateY(0)}
  .select{padding:10px}
  .muted{color:var(--muted)}
  .linklike{background:transparent}

  /* =========
     GRID
     ========= */
  .board{
    margin-top:18px;
    display:grid; gap:12px;
    grid-template-columns: repeat(4, 1fr);
  }
  .tile{
    position:relative;
    min-height: 120px;
    border-radius:14px;
    border:1px solid var(--tile-border);
    background: linear-gradient(180deg, #ffffff08, #00000000 30%), var(--tile);
    box-shadow: 0 10px 20px #00000030, inset 0 1px 0 #ffffff08;
    padding: 14px 14px 16px;
    display:flex; align-items:center; justify-content:center; text-align:center;
    font-weight:700; line-height:1.25; letter-spacing:.2px;
    transition: transform .12s ease, box-shadow .2s ease, border-color .15s ease, background-color .2s ease;
    user-select:none;
    overflow:hidden;
  }
  .tile:hover{ transform: translateY(-2px); box-shadow: 0 16px 36px #00000045; }
  .tile.checked{
    background:
      radial-gradient(200px 200px at 20% 0%, color-mix(in oklab, var(--accent) 25%, #0000), #0000 70%),
      var(--tile);
    border-color: color-mix(in oklab, var(--accent) 55%, var(--tile-border));
    box-shadow: 0 16px 40px color-mix(in oklab, #000 70%, var(--accent) 30%);
  }
  .checkmark{
    position:absolute; top:10px; left:10px; width:26px; height:26px; border-radius:8px;
    border:1px solid color-mix(in oklab, var(--accent) 70%, #000 30%);
    background: linear-gradient(#ffffff15, #0000), color-mix(in oklab, var(--accent) 25%, #000);
    display:grid; place-items:center;
    transform-origin: 12px 12px;
    transition: transform .18s ease, background-color .2s ease, border-color .2s ease, box-shadow .2s ease, opacity .2s ease;
    opacity:.75;
  }
  .tile.checked .checkmark{
    background: var(--accent);
    border-color: color-mix(in oklab, var(--accent) 80%, #000 20%);
    box-shadow: 0 8px 16px color-mix(in oklab, var(--accent) 35%, #000 65%);
    opacity:1;
    animation: pop .2s ease;
  }
  .checkmark svg{ width:18px; height:18px; filter: drop-shadow(0 1px 0 #0003)}
  @keyframes pop{ from{ transform: scale(.6) rotate(-10deg) } to{ transform: scale(1) rotate(0)} }
  .shine{
    position:absolute; inset:-40%; background: conic-gradient(from 210deg, #ffffff00 0 80%, #ffffff18 88%, #ffffff00 96%);
    transform: rotate(12deg); pointer-events:none; mix-blend-mode:soft-light;
    animation: spin 7s linear infinite;
  }
  @keyframes spin{ to{ transform: rotate(372deg)} }

  /* Reroll highlight */
  .tile.rerolling{ animation: reroll .45s ease; }
  @keyframes reroll{ 0%{transform: rotateY(0)} 50%{transform: rotateY(90deg)} 100%{transform: rotateY(0)} }

  /* Footer */
  footer{margin-top:14px; display:flex; gap:10px; justify-content:space-between; align-items:center; color:var(--muted)}
  .small{font-size:12px}

  /* Responsive */
  @media (max-width: 720px){
    .board{ grid-template-columns: repeat(2, 1fr); }
  }
</style>
</head>
<body class="theme-neon"> <!-- set default theme by class; options listed below -->
<div class="wrap">
  <header>
    <div class="title">
      <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M3 9h18v6H3z" stroke="currentColor" opacity=".45" />
        <path d="M7 3h10v18H7z" stroke="currentColor" opacity=".45" />
        <circle cx="12" cy="12" r="3.2" fill="currentColor"/>
      </svg>
      <h1>CS2 Bingo ‚Äî Challenge Tracker</h1>
      <span class="muted small">v1 (HTML)</span>
    </div>
    <div class="controls">
      <select id="theme" class="select" title="Theme">
        <option value="theme-default">Classic Dark</option>
        <option value="theme-neon" selected>Neon</option>
        <option value="theme-desert">Desert</option>
        <option value="theme-arctic">Arctic</option>
        <option value="theme-jungle">Jungle</option>
        <option value="theme-retro">Retro</option>
      </select>
      <button id="newCard">New Card</button>
      <button id="resetChecks">Reset Checks</button>
      <button id="reroll">Reroll Selected</button>
      <button id="exportBtn" title="Download current challenges as JSON">Export</button>
      <button id="importBtn" title="Import custom challenges JSON">Import</button>
    </div>
  </header>

  <main class="board" id="board" aria-live="polite" aria-label="Bingo Board"></main>

  <footer>
    <div class="small">
      Click tiles to check/uncheck. Use ‚ÄúReroll Selected‚Äù to swap the most recently clicked tile.
    </div>
    <div class="small">
      Themes:
      <span class="muted">Classic Dark, Neon, Desert, Arctic, Jungle, Retro</span>
    </div>
  </footer>
</div>

<!-- Minimal modal for import/export -->
<dialog id="modal" style="max-width:720px; width:92%; border:1px solid var(--tile-border); border-radius:12px; background:var(--panel); color:var(--text);">
  <form method="dialog" style="display:flex; flex-direction:column; gap:10px;">
    <h3 id="modalTitle" style="margin:0 0 6px 0;">Import / Export</h3>
    <textarea id="modalText" rows="12" style="width:100%; resize:vertical; border-radius:10px; background:var(--tile); color:var(--text); border:1px solid var(--tile-border); padding:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;"></textarea>
    <div style="display:flex; gap:10px; justify-content:flex-end;">
      <button value="cancel">Close</button>
      <button id="modalConfirm" value="default">Confirm</button>
    </div>
  </form>
</dialog>

<script>
/* =============================
   DATA: default CS2 challenges
   ============================= */
const DEFAULT_CHALLENGES = [
  // üî´ Combat
  { id: "headshot",        description: "Get a headshot" },
  { id: "double_hs",       description: "Get 2 headshots in a round" },
  { id: "pistol_kill",     description: "Kill with a pistol" },
  { id: "rifle_kill",      description: "Kill with a rifle" },
  { id: "sniper_kill",     description: "Kill with a sniper (AWP/Scout)" },
  { id: "smg_kill",        description: "Kill with an SMG" },
  { id: "shotgun_kill",    description: "Kill with a shotgun" },
  { id: "nade_kill",       description: "Kill with a grenade" },
  { id: "knife_kill",      description: "Kill with a knife" },
  { id: "zeus_kill",       description: "Kill with a Zeus" },
  { id: "wallbang",        description: "Damage or kill through a wall" },
  { id: "blind_kill",      description: "Kill while blinded" },
  { id: "jump_hs",         description: "Get a headshot while jumping" },
  { id: "no_scope",        description: "No-scope kill" },
  { id: "spray_transfer",  description: "2 kills in one spray" },

  // üß® Utility
  { id: "use_flash",       description: "Use a flashbang" },
  { id: "flash_assist",    description: "Get a flash assist" },
  { id: "use_molly",       description: "Use a molotov" },
  { id: "molly_dmg",       description: "Deal damage with molotov" },
  { id: "use_smoke",       description: "Use a smoke" },
  { id: "block_smoke",     description: "Extinguish a molly with smoke" },
  { id: "nade_dmg",        description: "Deal 50+ damage with HE grenade" },

  // üí£ Bomb play
  { id: "plant",           description: "Plant the bomb" },
  { id: "defuse",          description: "Defuse the bomb" },
  { id: "last_second_defuse", description: "Defuse in the last 5 seconds" },
  { id: "ninja_defuse",    description: "Ninja defuse" },
  { id: "bomb_carrier",    description: "Carry the bomb to site" },
  { id: "defend_bomb",     description: "Defend planted bomb until explosion" },

  // üõ°Ô∏è Round outcomes
  { id: "win_ct",          description: "Win a round as CT" },
  { id: "win_t",           description: "Win a round as T" },
  { id: "win_pistol",      description: "Win the pistol round" },
  { id: "eco_win",         description: "Win a round with pistols only" },
  { id: "force_buy_win",   description: "Win a round on a force buy" },
  { id: "full_buy_win",    description: "Win a full-buy round" },
  { id: "flawless_round",  description: "Win a round with no deaths" },

  // üë• Team play
  { id: "assist",          description: "Get an assist" },
  { id: "trade_kill",      description: "Trade a teammate" },
  { id: "entry",           description: "Get the entry frag" },
  { id: "support_util",    description: "Flash or smoke for a teammate" },
  { id: "drop_weapon",     description: "Drop a weapon for a teammate" },

  // üíÄ Clutch / Survival
  { id: "survive",         description: "Survive a round" },
  { id: "mvp",             description: "Be round MVP" },
  { id: "clutch_1v2",      description: "Win a 1v2 clutch" },
  { id: "clutch_1v3",      description: "Win a 1v3 clutch" },
  { id: "clutch_1v4",      description: "Win a 1v4 clutch" },
  { id: "ace",             description: "Get an ace (5 kills)" },
  { id: "save_awp",        description: "Save an AWP into the next round" },
  { id: "low_hp_win",      description: "Win round with <10 HP" },

  // üé≤ Fun/Challenge
  { id: "knife_round",     description: "Attempt a knife fight" },
  { id: "drop_decoy",      description: "Use a decoy grenade" },
  { id: "bomb_faked",      description: "Fake plant the bomb" },
  { id: "boost_teammate",  description: "Perform a boost with a teammate" },
  { id: "jump_peek",       description: "Jump peek an angle" },
  { id: "noscope_flick",   description: "Land a noscope flick" },
  { id: "switch_kill",     description: "Switch weapon right before a kill" }
];


/* =============================
   STATE
   ============================= */
const STORAGE_KEY = "cs2-bingo-v1";
const THEMES = ["theme-default","theme-neon","theme-desert","theme-arctic","theme-jungle","theme-retro"];

let allChallenges = [];
let board = [];       // 16 items: {id, description, checked}
let lastClickedIdx = null;

/* =============================
   UTIL
   ============================= */
const rand = (n)=> Math.floor(Math.random()*n);
function pickDistinct(arr, n){
  const pool = [...arr];
  const out = [];
  while(out.length<n && pool.length){
    out.push(pool.splice(rand(pool.length),1)[0]);
  }
  return out;
}
function save(){
  const payload = { board, theme: getThemeClass() };
  localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
}
function load(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return false;
    const data = JSON.parse(raw);
    if(Array.isArray(data.board)){
      board = data.board;
    }
    if(data.theme && THEMES.includes(data.theme)){
      setThemeClass(data.theme);
      document.getElementById('theme').value = data.theme;
    }
    return true;
  }catch{ return false; }
}

/* =============================
   RENDER
   ============================= */
const boardEl = document.getElementById("board");

function render(){
  boardEl.innerHTML = "";
  board.forEach((item, idx) => {
    const tile = document.createElement("button");
    tile.type = "button";
    tile.className = "tile" + (item.checked ? " checked" : "");
    tile.setAttribute("aria-pressed", item.checked ? "true" : "false");
    tile.dataset.index = idx;

    // checkmark
    tile.innerHTML = `
      <div class="shine"></div>
      <div class="checkmark" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M5 13l4 4L19 7" stroke="black" stroke-opacity=".25" stroke-width="4" stroke-linecap="round"/>
          <path d="M5 13l4 4L19 7" stroke="white" stroke-width="2.4" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="text">${escapeHtml(item.description)}</div>
    `;

    tile.addEventListener("click", () => {
      item.checked = !item.checked;
      lastClickedIdx = idx;
      tile.classList.toggle("checked");
      tile.setAttribute("aria-pressed", item.checked ? "true":"false");
      save();
    });

    tile.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " "){ e.preventDefault(); tile.click(); }
    });

    boardEl.appendChild(tile);
  });
}

function escapeHtml(s){
  return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
}

/* =============================
   ACTIONS
   ============================= */
function newCard(){
  const picked = pickDistinct(allChallenges, 16).map(c => ({...c, checked:false}));
  board = picked;
  lastClickedIdx = null;
  save();
  render();
  boardEl.animate([{opacity:.6, transform:"scale(.99)"},{opacity:1, transform:"scale(1)"}], {duration:220, easing:"ease-out"});
}

function resetChecks(){
  board.forEach(t=> t.checked=false);
  save(); render();
}

function rerollSelected(){
  if(lastClickedIdx === null){ flashHeader("Click a tile first to select a slot to reroll."); return; }
  // find a replacement not already on the board
  const currentIds = new Set(board.map(b=>b.id));
  const candidates = allChallenges.filter(c=> !currentIds.has(c.id));
  if(!candidates.length){ flashHeader("No spare challenges left to swap."); return; }
  const replacement = candidates[rand(candidates.length)];
  board[lastClickedIdx] = {...replacement, checked:false};
  save();
  // animation flair
  const tile = boardEl.querySelector(`.tile:nth-child(${lastClickedIdx+1})`);
  if(tile){ tile.classList.add("rerolling"); setTimeout(()=> tile.classList.remove("rerolling"), 460); }
  render();
}

function flashHeader(msg){
  const el = document.querySelector("header");
  el.title = msg;
  el.animate([{boxShadow:"0 0 0 rgba(0,0,0,0)"},{boxShadow:"0 0 0 6px color-mix(in oklab, var(--accent) 35%, transparent)"}],{duration:320, easing:"ease"});
}

/* =============================
   THEMES
   ============================= */
function getThemeClass(){
  const list = document.body.classList;
  return THEMES.find(t => list.contains(t)) || "theme-default";
}
function setThemeClass(next){
  document.body.classList.remove(...THEMES);
  if(next==="theme-default"){ document.body.classList.add("theme-default"); }
  else document.body.className = next;
  save();
}
document.getElementById("theme").addEventListener("change", (e)=> setThemeClass(e.target.value));

/* =============================
   IMPORT / EXPORT
   ============================= */
const modal = document.getElementById("modal");
const modalText = document.getElementById("modalText");
const modalTitle = document.getElementById("modalTitle");
const modalConfirm = document.getElementById("modalConfirm");

document.getElementById("exportBtn").addEventListener("click", ()=>{
  modalTitle.textContent = "Export challenges as JSON";
  const payload = { challenges: allChallenges };
  modalText.value = JSON.stringify(payload, null, 2);
  modalConfirm.onclick = ()=> {
    // Download as file
    const blob = new Blob([modalText.value], {type:"application/json"});
    const url = URL.createObjectURL(blob);
    const a = Object.assign(document.createElement("a"), { href:url, download:"challenges.json" });
    document.body.appendChild(a); a.click(); a.remove();
    setTimeout(()=> URL.revokeObjectURL(url), 500);
  };
  modal.showModal();
});

document.getElementById("importBtn").addEventListener("click", ()=>{
  modalTitle.textContent = "Import challenges JSON";
  modalText.value = `{\n  "challenges": [\n    { "id": "example", "description": "Your custom challenge" }\n  ]\n}`;
  modalConfirm.onclick = ()=> {
    try{
      const parsed = JSON.parse(modalText.value);
      if(!parsed || !Array.isArray(parsed.challenges)) throw new Error("Missing 'challenges' array");
      // sanitize
      allChallenges = parsed.challenges
        .filter(c => c && typeof c.description === "string" && c.description.trim().length)
        .map((c,i) => ({ id: c.id || `c_${i}_${Date.now()}`, description: String(c.description).trim() }));
      newCard();
      modal.close();
    }catch(err){
      alert("Invalid JSON: " + err.message);
    }
  };
  modal.showModal();
});

/* =============================
   INIT
   ============================= */
function init(){
  // start with defaults
  allChallenges = [...DEFAULT_CHALLENGES];
  // load from storage if present
  const hasState = load();
  if(!hasState || !Array.isArray(board) || board.length !== 16){
    newCard();
  } else {
    render();
  }
  // wire buttons
  document.getElementById("newCard").addEventListener("click", newCard);
  document.getElementById("resetChecks").addEventListener("click", resetChecks);
  document.getElementById("reroll").addEventListener("click", rerollSelected);
}
init();
</script>
</body>
</html>
